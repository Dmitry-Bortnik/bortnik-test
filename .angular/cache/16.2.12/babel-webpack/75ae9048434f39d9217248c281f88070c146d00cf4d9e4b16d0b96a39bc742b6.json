{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { DisplayIfPredicatePipe } from './../../../pipes/display-if-predicate.pipe';\nimport { MaterialModule } from './../../../core/material/material.module';\nimport { CheckboxComponent } from './../../../components/checkbox/checkbox.component';\nimport { MatSort, MatSortModule } from '@angular/material/sort';\nimport { MatTableDataSource } from '@angular/material/table';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/material/table\";\nimport * as i3 from \"@angular/material/sort\";\nfunction TableUsersComponent_ng_container_1_th_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"th\", 14)(1, \"div\", 15);\n    i0.ɵɵlistener(\"click\", function TableUsersComponent_ng_container_1_th_3_Template_div_click_1_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.onSelectAll());\n    });\n    i0.ɵɵelement(2, \"app-checkbox\", 16);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"minus\", ctx_r1.selectedUsers.length > 0 && ctx_r1.selectedUsers.length < ctx_r1.dataSource.length)(\"checked\", ctx_r1.selectedUsers.length === ctx_r1.dataSource.length);\n  }\n}\nfunction TableUsersComponent_ng_container_1_td_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\", 17)(1, \"app-checkbox\", 18);\n    i0.ɵɵlistener(\"checkboxClick\", function TableUsersComponent_ng_container_1_td_4_Template_app_checkbox_checkboxClick_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const element_r15 = restoredCtx.$implicit;\n      const ctx_r16 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r16.onUserSelect(element_r15));\n    });\n    i0.ɵɵpipe(2, \"displayIfPredicate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const element_r15 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"checked\", i0.ɵɵpipeBind3(2, 1, ctx_r2.selectedUsers, ctx_r2.isUserSelected, element_r15));\n  }\n}\nfunction TableUsersComponent_ng_container_1_th_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"\\u0418\\u043C\\u044F\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TableUsersComponent_ng_container_1_td_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r18 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r18.name, \" \");\n  }\n}\nfunction TableUsersComponent_ng_container_1_th_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TableUsersComponent_ng_container_1_td_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r19 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r19.surname, \" \");\n  }\n}\nfunction TableUsersComponent_ng_container_1_th_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"E-mail\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TableUsersComponent_ng_container_1_td_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r20 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r20.email, \" \");\n  }\n}\nfunction TableUsersComponent_ng_container_1_th_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TableUsersComponent_ng_container_1_td_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r21 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r21.phone, \" \");\n  }\n}\nfunction TableUsersComponent_ng_container_1_tr_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 21);\n  }\n}\nfunction TableUsersComponent_ng_container_1_tr_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 22);\n    i0.ɵɵlistener(\"click\", function TableUsersComponent_ng_container_1_tr_18_Template_tr_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r24);\n      const element_r22 = restoredCtx.$implicit;\n      const ctx_r23 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r23.onEdit(element_r22));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TableUsersComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"table\", 2);\n    i0.ɵɵelementContainerStart(2, 3);\n    i0.ɵɵtemplate(3, TableUsersComponent_ng_container_1_th_3_Template, 3, 2, \"th\", 4);\n    i0.ɵɵtemplate(4, TableUsersComponent_ng_container_1_td_4_Template, 3, 5, \"td\", 5);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(5, 6);\n    i0.ɵɵtemplate(6, TableUsersComponent_ng_container_1_th_6_Template, 2, 0, \"th\", 7);\n    i0.ɵɵtemplate(7, TableUsersComponent_ng_container_1_td_7_Template, 2, 1, \"td\", 8);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(8, 9);\n    i0.ɵɵtemplate(9, TableUsersComponent_ng_container_1_th_9_Template, 2, 0, \"th\", 7);\n    i0.ɵɵtemplate(10, TableUsersComponent_ng_container_1_td_10_Template, 2, 1, \"td\", 8);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(11, 10);\n    i0.ɵɵtemplate(12, TableUsersComponent_ng_container_1_th_12_Template, 2, 0, \"th\", 7);\n    i0.ɵɵtemplate(13, TableUsersComponent_ng_container_1_td_13_Template, 2, 1, \"td\", 8);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(14, 11);\n    i0.ɵɵtemplate(15, TableUsersComponent_ng_container_1_th_15_Template, 2, 0, \"th\", 7);\n    i0.ɵɵtemplate(16, TableUsersComponent_ng_container_1_td_16_Template, 2, 1, \"td\", 8);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵtemplate(17, TableUsersComponent_ng_container_1_tr_17_Template, 1, 0, \"tr\", 12);\n    i0.ɵɵtemplate(18, TableUsersComponent_ng_container_1_tr_18_Template, 1, 0, \"tr\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"dataSource\", ctx_r0.dataSourceWithSort);\n    i0.ɵɵadvance(16);\n    i0.ɵɵproperty(\"matHeaderRowDef\", ctx_r0.displayedColumns)(\"matHeaderRowDefSticky\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"matRowDefColumns\", ctx_r0.displayedColumns);\n  }\n}\nexport let TableUsersComponent = /*#__PURE__*/(() => {\n  class TableUsersComponent {\n    constructor() {\n      this.dataSource = [];\n      this.selectedUsers = [];\n      this.selectedUsersChange = new EventEmitter();\n      this.removeEndpoint = new EventEmitter();\n      this.edit = new EventEmitter();\n      this.dataSourceWithSort = new MatTableDataSource([]);\n      this.selectedUser = [];\n      this.displayedColumns = ['checkbox', 'name', 'surname', 'email', 'phone'];\n      this.isUserSelected = (selectedUsers, user) => {\n        return selectedUsers.some(({\n          email\n        }) => email === user.email);\n      };\n    }\n    ngAfterViewInit() {\n      this.dataSourceWithSort.sort = this.sort;\n    }\n    ngOnInit() {}\n    ngOnChanges(changes) {\n      if (changes['dataSource']) {\n        this.dataSourceWithSort.data = this.dataSource;\n      }\n    }\n    onEdit(el) {\n      this.edit.emit(el);\n    }\n    onSelectAll() {\n      const users = this.dataSourceWithSort.data ?? [];\n      const localSelectedUsers = this.getLocalSelectedUsers(users, this.selectedUsers);\n      if (localSelectedUsers.length) {\n        const set = new Set(users.map(user => user.email ?? 0));\n        const result = this.selectedUsers.filter(user => !set.has(user.email ?? 0));\n        this.selectedUsers = result;\n        return;\n      }\n      const result = [...this.selectedUsers, ...users];\n      this.selectedUsers = result;\n      this.selectedUsersChange.emit(this.selectedUsers);\n    }\n    getLocalSelectedUsers(users, selectedUsers) {\n      const set = new Set(users.map(user => user.email ?? 0));\n      return selectedUsers.filter(user => set.has(user.email ?? 0));\n    }\n    onUserSelect(user) {\n      event?.stopPropagation();\n      if (!this.dataSourceWithSort.data.length) return;\n      const userFromCollection = this.selectedUsers.find(({\n        email\n      }) => email === user.email);\n      if (userFromCollection) {\n        const selectedUsers = this.selectedUsers.filter(({\n          email\n        }) => email !== user.email);\n        this.selectedUsersChange.emit(selectedUsers);\n        return;\n      }\n      const selectedUsers = [...this.selectedUsers, user];\n      this.selectedUsersChange.emit(selectedUsers);\n    }\n    static #_ = this.ɵfac = function TableUsersComponent_Factory(t) {\n      return new (t || TableUsersComponent)();\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: TableUsersComponent,\n      selectors: [[\"app-table-users\"]],\n      viewQuery: function TableUsersComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(MatSort, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sort = _t.first);\n        }\n      },\n      inputs: {\n        dataSource: \"dataSource\",\n        selectedUsers: \"selectedUsers\"\n      },\n      outputs: {\n        selectedUsersChange: \"selectedUsersChange\",\n        removeEndpoint: \"removeEndpoint\",\n        edit: \"edit\"\n      },\n      standalone: true,\n      features: [i0.ɵɵNgOnChangesFeature, i0.ɵɵStandaloneFeature],\n      decls: 2,\n      vars: 1,\n      consts: [[1, \"table-container\"], [4, \"ngIf\"], [\"mat-table\", \"\", \"matSort\", \"\", 3, \"dataSource\"], [\"matColumnDef\", \"checkbox\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"class\", \"cell-checkbox\", \"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"name\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"surname\"], [\"matColumnDef\", \"email\"], [\"matColumnDef\", \"phone\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\", \"matHeaderRowDefSticky\"], [\"mat-row\", \"\", 3, \"click\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"mat-header-cell\", \"\"], [1, \"control-button\", \"select-all\", 3, \"click\"], [3, \"minus\", \"checked\"], [\"mat-cell\", \"\", 1, \"cell-checkbox\"], [3, \"checked\", \"checkboxClick\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\"], [\"mat-cell\", \"\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\", 3, \"click\"]],\n      template: function TableUsersComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵtemplate(1, TableUsersComponent_ng_container_1_Template, 19, 4, \"ng-container\", 1);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.dataSource);\n        }\n      },\n      dependencies: [CommonModule, i1.NgIf, MaterialModule, i2.MatTable, i2.MatHeaderCellDef, i2.MatHeaderRowDef, i2.MatColumnDef, i2.MatCellDef, i2.MatRowDef, i2.MatHeaderCell, i2.MatCell, i2.MatHeaderRow, i2.MatRow, i3.MatSort, i3.MatSortHeader, FormsModule, DisplayIfPredicatePipe, CheckboxComponent, MatSortModule],\n      changeDetection: 0\n    });\n  }\n  return TableUsersComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}